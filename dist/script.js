"use strict";var input=document.getElementById("searchInput"),searchButton=document.getElementById("searchBtn"),btnMetric=document.querySelector(".btn--metric");function isoToDate(e){var t;return t="weekday"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"full")?{weekday:"short"}:{weekday:"long",year:"numeric",month:"short",day:"numeric"},new Date(e).toLocaleDateString("en-US",t)}function formatHour(e){var t=new Date(e).getHours(),n=t>=12?" PM":" AM";return"".concat(t=0===(t%=12)?12:t).concat(n)}function updateWeatherUI(e){document.getElementById("time").textContent=isoToDate(e.current.time),document.getElementById("temperature").textContent=Math.round(e.current.temperature_2m)+"°",document.getElementById("weather-code-icon").src=weatherIcon(e.current.weather_code),document.getElementById("temperature-feels").textContent=Math.round(e.current.apparent_temperature)+e.current_units.apparent_temperature,document.getElementById("humidity").textContent=e.current.relative_humidity_2m+"%",document.getElementById("wind").textContent=Math.round(e.current.wind_speed_10m)+e.current_units.wind_speed_10m,document.getElementById("precipitation").textContent=e.current.precipitation+e.current_units.precipitation;var t=document.querySelector(".forecast_container");t.innerHTML="";for(var n=0;n<7;n++){var r=e.daily.time[n],a=e.daily.temperature_2m_max[n],c=e.daily.temperature_2m_min[n],o=weatherIcon(e.daily.weather_code[n]);t.innerHTML+='\n      <div class="card py-4 px-2.5">\n        <h3 class="card__title">\n          '.concat(isoToDate(r,"weekday"),'\n        </h3>\n        <img src="').concat(o,'" alt="Weather Icon" class="card__icon">\n        <div class="card__temperatures flex justify-between">\n          <p class="card__temperature">\n            ').concat(Math.round(a),"<sup>").concat(e.daily_units.temperature_2m_max,'</sup>\n          </p>\n          <p class="card__temperature card__temperature--low">\n            ').concat(Math.round(c),"<sup>").concat(e.daily_units.temperature_2m_max,"</sup>\n          </p>\n        </div>\n      </div>\n    ")}var i=document.querySelector(".hourly_container");i.innerHTML="";for(var u=new Date,s=e.hourly.time.findIndex(function(e){return new Date(e)>=u}),m=s;m<s+8;m++){var d=e.hourly.temperature_2m[m],l=weatherIcon(e.hourly.weather_code[m]),p=formatHour(e.hourly.time[m]);i.innerHTML+='\n      <div class="hourly_container card card--light flex flex-row items-center justify-between mt-4 py-2 px-3">\n        <div class="flex flex-row items-center">\n          <img src="'.concat(l,'" alt="" class="card__icon w-10">\n          <p class="card__hour ml-2">').concat(p,'</p>\n        </div>\n  \n        <p class="card__temperature">').concat(d,"<sup>°</sup></p>\n      </div>\n    ")}}function weatherIcon(e){return 0===e?"./assets/images/icon-sunny.webp":2===e?"./assets/images/icon-partly-cloudy.webp":1===e||3===e?"./assets/images/icon-overcast.webp":45===e||48===e?"./assets/images/icon-fog.webp":53===e?"./assets/images/icon-drizzle.webp":63===e?"./assets/images/icon-rain.webp":73===e?"./assets/images/icon-snow.webp":95===e?"./assets/images/icon-storm.webp":"./assets/images/icon-sunny.webp"}var dropdown=document.querySelector(".dropdown-content"),buttonDropdown=document.querySelector(".dropdown-button");function fetchWeather(e){var t=e.value,n=e.unit;return fetch("http://localhost:3002/api/search?q=".concat(encodeURIComponent(t))).then(function(e){return e.json()}).then(function(e){if(e.length){var t=e[0],r=t.lat,a=t.lon,c=t.display_name.split(","),o=c[0].trim()+", "+c[c.length-1].trim();document.getElementById("location").textContent=o;var i="https://api.open-meteo.com/v1/forecast?latitude=".concat(r,"&longitude=").concat(a,"&daily=weather_code,temperature_2m_max,temperature_2m_min&current=temperature_2m,relative_humidity_2m,precipitation,wind_speed_10m,apparent_temperature,weather_code&hourly=temperature_2m,weather_code&timezone=auto"),u={metric:i,imperial:"".concat(i,"&wind_speed_unit=mph&temperature_unit=fahrenheit&precipitation_unit=inch")};return fetch(u[n])}alert("Aucun résultat trouvé !")})}buttonDropdown.addEventListener("click",function(){dropdown.style.display="block"===dropdown.style.display?"none":"block"});var currentCity=null,currentUnit="metric";searchButton.addEventListener("click",function(){var e=input.value;fetchWeather({value:currentCity=e,unit:currentUnit}).then(function(e){return e.json()}).then(function(e){console.log(e),updateWeatherUI(e)}).catch(function(e){return console.error(e)})}),btnMetric.addEventListener("click",function(){currentUnit="metric"===currentUnit?"imperial":"metric",btnMetric.innerHTML="imperial"===currentUnit?"Switch to Metric":"Switch to Imperial",fetchWeather({value:currentCity,unit:currentUnit}).then(function(e){return e.json()}).then(function(e){console.log(e),updateWeatherUI(e)}).catch(function(e){return console.error(e)})});var unitValue="metric",tempValue="celsius",windValue="km",prepValue="mm";//# sourceMappingURL=script.js.map
